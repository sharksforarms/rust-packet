use rust_packet::prelude::*;
use hex_literal::hex;

fn main() {
    let input = hex!("b40c25058e13000c29c134dc86dd6000000001430640200300de20160125fc3683174e86cb72200300de20160110000000000a1204431d76005072e11aa7e255014450183f9eAAAA0000474554202f66617669636f6e2e69636f20485454502f312e310d0a486f73743a2069702e77656265726e65747a2e6e65740d0a557365722d4167656e743a204d6f7a696c6c612f352e30202857696e646f7773204e5420362e313b2072763a35392e3029204765636b6f2f32303130303130312046697265666f782f35392e300d0a4163636570743a20746578742f68746d6c2c6170706c69636174696f6e2f7868746d6c2b786d6c2c6170706c69636174696f6e2f786d6c3b713d302e392c2a2f2a3b713d302e380d0a4163636570742d4c616e67756167653a2064652c656e2d55533b713d302e372c656e3b713d302e330d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174650d0a436f6e6e656374696f6e3a206b6565702d616c6976650d0a0d0a");

    // From bytes
    let mut pkt = Packet::from_bytes(input.as_ref()).unwrap();

    // Modify the IPv4 Layer
    if let Some(ipv4) = pkt.ipv4_mut() {
        ipv4.dst = "127.0.0.2".parse().unwrap();
    }

    // Modify the TCP layer
    if let Some(tcp) = pkt.tcp_mut() {
        tcp.dport = 8081;
    }

    // Update the IP and TCP checksums
    pkt.update().unwrap();

    // To bytes
    let _output: Vec<u8> = pkt.to_bytes().unwrap();
}
